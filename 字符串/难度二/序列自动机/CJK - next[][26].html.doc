<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>next[][26].html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}@import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:"Roboto Condensed",Tauri,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;background-color:rgba(0,0,0,.02);padding:.2em .5em;border:1px solid #efefef}.haroopad pre>code{font-size:1em;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#23241f;-webkit-text-size-adjust:none}.aspectj .hljs-function,.css .hljs-function .hljs-preprocessor,.css .hljs-rules,.css .hljs-value,.hljs,.hljs-pragma,.hljs-tag{color:#f8f8f2}.hljs-emphasis,.hljs-strong,.hljs-strongemphasis{color:#a8a8a2}.alias .hljs-keyword,.hljs-blockquote,.hljs-bullet,.hljs-hexcolor,.hljs-horizontal_rule,.hljs-literal,.hljs-number,.hljs-regexp{color:#ae81ff}.css .hljs-class,.hljs-class .hljs-title:last-child,.hljs-code,.hljs-tag .hljs-value,.hljs-title{color:#a6e22e}.hljs-link_url{font-size:80%}.hljs-strong,.hljs-strongemphasis{font-weight:700}.hljs-class .hljs-title:last-child,.hljs-emphasis,.hljs-strongemphasis,.hljs-typename{font-style:italic}.alias .hljs-keyword:first-child,.css .hljs-important,.css .hljs-tag,.css .unit,.hljs-attribute,.hljs-change,.hljs-flow,.hljs-function,.hljs-header,.hljs-keyword,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-tag .hljs-title,.hljs-value,.hljs-winutils,.nginx .hljs-title,.ruby .hljs-class .hljs-keyword:first-child,.ruby .hljs-function .hljs-keyword,.tex .hljs-special{color:#f92672}.css .hljs-attribute,.hljs-aspect .hljs-keyword:first-child,.hljs-class .hljs-keyword:first-child,.hljs-constant,.hljs-function .hljs-keyword,.hljs-typename{color:#66d9ef}.hljs-aspect .hljs-title,.hljs-class .hljs-title,.hljs-params,.hljs-variable{color:#f8f8f2}.apache .hljs-cbracket,.apache .hljs-tag,.css .hljs-id,.django .hljs-filter .hljs-argument,.django .hljs-template_tag,.django .hljs-variable,.hljs-addition,.hljs-attr_selector,.hljs-built_in,.hljs-envvar,.hljs-link_label,.hljs-link_url,.hljs-prompt,.hljs-pseudo,.hljs-stream,.hljs-string,.hljs-subst,.hljs-type,.ruby .hljs-class .hljs-parent,.smalltalk .hljs-array,.smalltalk .hljs-class,.smalltalk .hljs-localvars,.tex .hljs-command{color:#e6db74}.apache .hljs-sqbracket,.hljs-annotation,.hljs-comment,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-javadoc,.hljs-pi,.hljs-shebang,.tex .hljs-formula{color:#75715e}.coffeescript .javascript,.javascript .xml,.php .xml,.tex .hljs-formula,.xml .css,.xml .hljs-cdata,.xml .javascript,.xml .php,.xml .vbscript{opacity:.5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}.MathJax_Display{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}.MathJax .merror{background-color:#FF8;color:#C00;border:1px solid #C00;padding:1px 3px;font-style:normal;font-size:90%}.MathJax .MJX-monospace{font-family:monospace}.MathJax .MJX-sans-serif{font-family:sans-serif}#MathJax_Tooltip{background-color:InfoBackground;color:InfoText;border:1px solid #000;box-shadow:2px 2px 5px #AAA;-webkit-box-shadow:2px 2px 5px #AAA;-moz-box-shadow:2px 2px 5px #AAA;-khtml-box-shadow:2px 2px 5px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true');padding:3px 4px;z-index:401;position:absolute;left:0;top:0;width:auto;height:auto;display:none}.MathJax{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.MathJax a,.MathJax img,.MathJax nobr{border:0;padding:0;margin:0;max-width:5000em;max-height:5000em;min-width:0;min-height:0;vertical-align:0;line-height:normal;text-decoration:none}img.MathJax_strut{border:0!important;padding:0!important;margin:0!important;vertical-align:0!important}.MathJax span{display:inline;position:static;border:0;padding:0;margin:0;vertical-align:0;line-height:normal;text-decoration:none}.MathJax nobr{white-space:nowrap!important}.MathJax img{display:inline!important;float:none!important}.MathJax *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.MathJax_Processing{visibility:hidden;position:fixed;width:0;height:0;overflow:hidden}.MathJax_Processed{display:none!important}.MathJax_ExBox{display:block!important;overflow:hidden;width:1px;height:60ex;min-height:0;max-height:none}.MathJax .MathJax_EmBox{display:block!important;overflow:hidden;width:1px;height:60em;min-height:0;max-height:none}.MathJax .MathJax_HitBox{cursor:text;background:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_Tooltip *,.MathJax .MathJax_HitBox *{filter:none;opacity:1;background:0 0}@font-face{font-family:MathJax_Main;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Main;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2) format('opentype');font-weight:700}@font-face{font-family:MathJax_Main;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Math;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Caligraphic;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size1;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size2;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size3;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size4;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2) format('opentype')}.MathJax .noError{font-size:90%;text-align:left;color:#000;padding:1px 3px;border:1px solid}@font-face{font-family:MathJax_AMS;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.4-beta-2) format('opentype')}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">
<h1 id="next数组在子序列计数、最优化问题中的应用"><a name="next数组在子序列计数、最优化问题中的应用" href="#next数组在子序列计数、最优化问题中的应用"></a>next数组在子序列计数、最优化问题中的应用</h1><p>pb_ds</p><p class="toc" style="undefined"></p><ul>
<li><ul>
<li><span class="title">
<a href="#摘要" title="摘要">摘要</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="title">
<a href="#定义及构造" title="定义及构造">定义及构造</a>
</span>
<!--span class="number">
1
</span-->
</li>
<li><span class="title">
<a href="#单串问题" title="单串问题">单串问题</a>
</span>
<!--span class="number">
2
</span-->
<ul>
<li><span class="title">
<a href="#0-最小字典序子序列" title="0 最小字典序子序列">0 最小字典序子序列</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="title">
<a href="#1-子序列计数" title="1 子序列计数">1 子序列计数</a>
</span>
<!--span class="number">
4
</span-->
</li>
<li><span class="title">
<a href="#2-最长上升子序列" title="2 最长上升子序列">2 最长上升子序列</a>
</span>
<!--span class="number">
5
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#公共子序列相关" title="公共子序列相关">公共子序列相关</a>
</span>
<!--span class="number">
6
</span-->
<ul>
<li><span class="title">
<a href="#3-最小字典序公共子序列" title="3 最小字典序公共子序列">3 最小字典序公共子序列</a>
</span>
<!--span class="number">
7
</span-->
</li>
<li><span class="title">
<a href="#4-公共子序列计数（fjoi2016）" title="4 公共子序列计数（FJOI2016）">4 公共子序列计数（FJOI2016）</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li><span class="title">
<a href="#5-最长公共子序列" title="5 最长公共子序列">5 最长公共子序列</a>
</span>
<!--span class="number">
9
</span-->
</li>
<li><span class="title">
<a href="#6-带单串作为子序列包含约束的lis（fjoi2013）" title="6 带单串作为子序列包含约束的LIS（FJOI2013）">6 带单串作为子序列包含约束的LIS（FJOI2013）</a>
</span>
<!--span class="number">
10
</span-->
</li>
<li><span class="title">
<a href="#7-最短不公共子序列（heoi2015）" title="7 最短不公共子序列（HEOI2015）">7 最短不公共子序列（HEOI2015）</a>
</span>
<!--span class="number">
11
</span-->
</li>
<li><span class="title">
<a href="#8-多个串的公共子序列" title="8 多个串的公共子序列">8 多个串的公共子序列</a>
</span>
<!--span class="number">
12
</span-->
</li>
<li><span class="title">
<a href="#9-两个串带多串作为子串包含的公共子序列（fjoi2015）" title="9 两个串带多串作为子串包含的公共子序列（FJOI2015）">9 两个串带多串作为子串包含的公共子序列（FJOI2015）</a>
</span>
<!--span class="number">
13
</span-->
</li>
<li><span class="title">
<a href="#10-多个串的公共上升子序列" title="10 多个串的公共上升子序列">10 多个串的公共上升子序列</a>
</span>
<!--span class="number">
14
</span-->
</li>
<li><span class="title">
<a href="#11-回文子序列计数" title="11 回文子序列计数">11 回文子序列计数</a>
</span>
<!--span class="number">
15
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#字典序及长度相关" title="字典序及长度相关">字典序及长度相关</a>
</span>
<!--span class="number">
16
</span-->
<ul>
<li><span class="title">
<a href="#12-子序列长度之和" title="12 子序列长度之和">12 子序列长度之和</a>
</span>
<!--span class="number">
17
</span-->
</li>
<li><span class="title">
<a href="#13-长度区间范围内计数" title="13 长度区间范围内计数">13 长度区间范围内计数</a>
</span>
<!--span class="number">
18
</span-->
</li>
<li><span class="title">
<a href="#14-长度范围内最小字典序子序列" title="14 长度范围内最小字典序子序列">14 长度范围内最小字典序子序列</a>
</span>
<!--span class="number">
19
</span-->
</li>
<li><span class="title">
<a href="#15-长度范围内最小字典序公共子序列" title="15 长度范围内最小字典序公共子序列">15 长度范围内最小字典序公共子序列</a>
</span>
<!--span class="number">
20
</span-->
</li>
<li><span class="title">
<a href="#16-k小字典序子序列（相同的算一个）" title="16 k小字典序子序列（相同的算一个）">16 k小字典序子序列（相同的算一个）</a>
</span>
<!--span class="number">
21
</span-->
</li>
<li><span class="title">
<a href="#17-长度范围内的k小字典序子序列（相同的算一个）" title="17 长度范围内的k小字典序子序列（相同的算一个）">17 长度范围内的k小字典序子序列（相同的算一个）</a>
</span>
<!--span class="number">
22
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#总结" title="总结">总结</a>
</span>
<!--span class="number">
23
</span-->
</li>
</ul>
</li>

</ul>
<p></p><h2 id="摘要"><a name="摘要" href="#摘要"></a>摘要</h2><p>在OI比赛（特别是FJOI）中，常常会出现一类和<strong>子序列</strong>有关的计数、最优化问题。在以前，这类问题并没有一些比较通用的思考方法，导致了较大的思维复杂度，也使得状态数优化较为困难。<br>而一类<strong>子串</strong>问题中，我们引入和<strong>后缀自动机</strong>（SAM）这一有限状态自动机。在这类问题中，我们左有后缀自动机的简单构造，右有自动机和后缀树的优美性质，SAM常常能所向披靡，轻而易举的解决各类和子串有关的问题。<br>本文提出了next数组这一能识别一个串所有子序列的“序列自动机”，描述了它的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3353-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24501" style="width: 6.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.137em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24502"><span class="mi" id="MathJax-Span-24503" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24504" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24505" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-24506"><span class="mrow" id="MathJax-Span-24507"><span class="mo" id="MathJax-Span-24508" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24509" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24510" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24511" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24512" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24513" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24514"><span class="mrow" id="MathJax-Span-24515"><span class="mo" id="MathJax-Span-24516" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24517" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3353">O(n|alpha|)</script></span>构造算法，并从一些例题展开讨论。</p><h2 id="定义及构造"><a name="定义及构造" href="#定义及构造"></a>定义及构造</h2><p>设next[i][w]表示在原串<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3354-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24518" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24519"><span class="mi" id="MathJax-Span-24520" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3354">s</script></span>第i位<strong>后面</strong>的<strong>第一个</strong>w出现的位置（如果没有，则next[i][w] = -1）。则以0为初始节点，next[i][w]转移函数，所有节点为接受状态的有限状态自动机为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3355-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24521" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24522"><span class="mi" id="MathJax-Span-24523" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3355">s</script></span>的序列自动机。<br>显然，最简单的构造方法是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3356-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24524" style="width: 6.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.137em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24525"><span class="mi" id="MathJax-Span-24526" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24527" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24528" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-24529"><span class="mrow" id="MathJax-Span-24530"><span class="mo" id="MathJax-Span-24531" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24532" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24533" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24534" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24535" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24536" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24537"><span class="mrow" id="MathJax-Span-24538"><span class="mo" id="MathJax-Span-24539" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24540" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3356">O(n|alpha|)</script></span>的：</p><pre><code data-origin="<pre><code>def build(s, next):
    n = |s|
    next[n][*] = -1
    for i = n -&amp;gt; 1:
        for j in A:
            next[i - 1][j] = next[i][j]
        next[i - 1][s[i]] = i
</code></pre>">def build(s, next):
    n = |s|
    next[n][*] = -1
    for i = n -&gt; 1:
        for j in A:
            next[i - 1][j] = next[i][j]
        next[i - 1][s[i]] = i
</code></pre><p>构造完毕后，我们就可以开始使用了。<br>这里也明显的突出了next数组的缺点：不适合<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3357-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24541" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24542"><span class="texatom" id="MathJax-Span-24543"><span class="mrow" id="MathJax-Span-24544"><span class="mo" id="MathJax-Span-24545" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24546" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24547" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24548" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24549" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24550" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24551"><span class="mrow" id="MathJax-Span-24552"><span class="mo" id="MathJax-Span-24553" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.352em; vertical-align: -0.37em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3357">|alpha|</script></span>太大的应用。</p><h2 id="单串问题"><a name="单串问题" href="#单串问题"></a>单串问题</h2><p>这里将介绍一些经典的单串问题（不一定是DP）。</p><h3 id="0-最小字典序子序列"><a name="0-最小字典序子序列" href="#0-最小字典序子序列"></a>0 最小字典序子序列</h3><p>给一个串，求一个字典序最小的子序列。显然这是一个非常简单的问题，但我们考虑用next数组来做。<br>next数组可以看作是一棵缩成DAG的trie树（其实就是trie图），因此我们按照最小字典序在next数组上走就行了。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3358-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24554" style="width: 10.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.415em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.768em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24555"><span class="mi" id="MathJax-Span-24556" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24557" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-24558"><span class="mrow" id="MathJax-Span-24559"><span class="mo" id="MathJax-Span-24560" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-24561"><span class="mrow" id="MathJax-Span-24562"><span class="mo" id="MathJax-Span-24563"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">输</span></span></span></span><span class="texatom" id="MathJax-Span-24564"><span class="mrow" id="MathJax-Span-24565"><span class="mo" id="MathJax-Span-24566"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">出</span></span></span></span><span class="texatom" id="MathJax-Span-24567"><span class="mrow" id="MathJax-Span-24568"><span class="mo" id="MathJax-Span-24569"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">规</span></span></span></span><span class="texatom" id="MathJax-Span-24570"><span class="mrow" id="MathJax-Span-24571"><span class="mo" id="MathJax-Span-24572"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">模</span></span></span></span><span class="texatom" id="MathJax-Span-24573"><span class="mrow" id="MathJax-Span-24574"><span class="mo" id="MathJax-Span-24575" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-24576"><span class="mrow" id="MathJax-Span-24577"><span class="mo" id="MathJax-Span-24578" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24579" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24580" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24581" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24582" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24583" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24584"><span class="mrow" id="MathJax-Span-24585"><span class="mo" id="MathJax-Span-24586" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24587" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.414em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3358">O(|输出规模||alpha|)</script></span>。</p><h3 id="1-子序列计数"><a name="1-子序列计数" href="#1-子序列计数"></a>1 子序列计数</h3><p>给一个串，求它不同子序列计数。其实就是求next数组扩展成trie树的节点数。<br>暴力统计显然不行，比如一个1~n的排列，任何子序列均不同，因此答案达到<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3359-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24588" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.262em 1000em 2.295em -0.442em); top: -2.131em; left: 0em;"><span class="mrow" id="MathJax-Span-24589"><span class="msubsup" id="MathJax-Span-24590"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-24591" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.633em; left: 0.546em;"><span class="mi" id="MathJax-Span-24592" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.131em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.994em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3359">2^n</script></span>。<br>考虑另一种思路，next数组可以看成DAG，任何一条从0到任意节点的路径都是一个不同的子序列，因此我们统计的就是从0开始的路径条数，DAG上DP即可。并且由于点的编号就是拓扑序，实现起来十分方便，可以不用显式的建出数组。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3360-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24593" style="width: 6.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.137em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24594"><span class="mi" id="MathJax-Span-24595" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24596" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24597" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-24598"><span class="mrow" id="MathJax-Span-24599"><span class="mo" id="MathJax-Span-24600" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24601" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24602" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24603" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24604" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24605" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24606"><span class="mrow" id="MathJax-Span-24607"><span class="mo" id="MathJax-Span-24608" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24609" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3360">O(n|alpha|)</script></span>。<br>注意到这里的路径和子序列是一一对应的，而DAG上的DP又是我们熟悉的，因此我们能这样不重不漏的统计子序列，这给了我们一个不错的计数方式。</p><h3 id="2-最长上升子序列"><a name="2-最长上升子序列" href="#2-最长上升子序列"></a>2 最长上升子序列</h3><p>给定一个串，求一个最长的上升子序列。<br>由于要求上升，则<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3361-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24610" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.383em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.689em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24611"><span class="mi" id="MathJax-Span-24612" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3361">i</script></span>连出的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3362-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24613" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.724em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24614"><span class="mi" id="MathJax-Span-24615" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24616" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-24617" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-24618" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.91em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3362">next</script></span>只有超过<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3363-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24619" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.525em 1000em 2.453em -0.439em); top: -2.131em; left: 0em;"><span class="mrow" id="MathJax-Span-24620"><span class="msubsup" id="MathJax-Span-24621"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24622" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-24623" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.131em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3363">s_i</script></span>部分需要保留，其他都可以删去（我们姑且称这个新的自动机为上升序列自动机），这样我们就把问题转化为DAG上最长路，仍然是我们熟知的模型。但无法胜任<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3364-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24624" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24625"><span class="texatom" id="MathJax-Span-24626"><span class="mrow" id="MathJax-Span-24627"><span class="mo" id="MathJax-Span-24628" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24629" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24630" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24631" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24632" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24633" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24634"><span class="mrow" id="MathJax-Span-24635"><span class="mo" id="MathJax-Span-24636" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.352em; vertical-align: -0.37em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3364">|alpha|</script></span>较大的情况。<br>对于<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3365-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24637" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24638"><span class="texatom" id="MathJax-Span-24639"><span class="mrow" id="MathJax-Span-24640"><span class="mo" id="MathJax-Span-24641" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24642" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24643" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24644" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24645" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24646" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24647"><span class="mrow" id="MathJax-Span-24648"><span class="mo" id="MathJax-Span-24649" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.352em; vertical-align: -0.37em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3365">|alpha|</script></span>较大的情况，我们考虑直接在构造时维护最大值。这就等同于用树状数组求LIS。<br>殊途同归。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3366-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24650" style="width: 8.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.776em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24651"><span class="mi" id="MathJax-Span-24652" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24653" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24654" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24655" style="font-family: MathJax_Main; padding-left: 0.167em;">log</span><span class="mo" id="MathJax-Span-24656"></span><span class="texatom" id="MathJax-Span-24657" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-24658"><span class="mo" id="MathJax-Span-24659" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24660" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24661" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24662" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24663" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24664" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24665"><span class="mrow" id="MathJax-Span-24666"><span class="mo" id="MathJax-Span-24667" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24668" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3366">O(n \log |alpha|)</script></span>。<br>这个做法可以轻松推广到计数问题上。</p><h2 id="公共子序列相关"><a name="公共子序列相关" href="#公共子序列相关"></a>公共子序列相关</h2><p>一个串是两个串的公共子序列，当且仅当它在两个序列自动机中都有对应的节点。<br>我们用一个<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3367-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24669" style="width: 2.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.186em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24670"><span class="mo" id="MathJax-Span-24671" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24672" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-24673" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24674" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-24675" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3367">(a, b)</script></span>表示一个串在<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3368-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24676" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24677"><span class="mi" id="MathJax-Span-24678" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24679" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3368">s0</script></span>的序列自动机的节点<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3369-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24680" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24681"><span class="mi" id="MathJax-Span-24682" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.684em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3369">a</script></span>，在<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3370-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24683" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.906em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24684"><span class="mi" id="MathJax-Span-24685" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24686" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.958em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3370">s1</script></span>的序列自动机的节点<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3371-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24687" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24688"><span class="mi" id="MathJax-Span-24689" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3371">b</script></span>，则对于一个字母<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3372-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24690" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24691"><span class="mi" id="MathJax-Span-24692" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.687em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3372">w</script></span>，如果<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3373-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24693" style="width: 9.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.486em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24694"><span class="mi" id="MathJax-Span-24695" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24696" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-24697" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-24698" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mn" id="MathJax-Span-24699" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24700" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24701" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-24702" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24703" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24704" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-24705" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24706" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-24707" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-24708" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3373">next0[a][w] \ne -1</script></span>且<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3374-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24709" style="width: 9.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.377em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24710"><span class="mi" id="MathJax-Span-24711" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24712" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-24713" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-24714" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mn" id="MathJax-Span-24715" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24716" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24717" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-24718" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24719" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24720" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-24721" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24722" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-24723" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-24724" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3374">next1[b][w] \ne -1</script></span>，则可以在这个串后面加一个字母<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3375-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24725" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24726"><span class="mi" id="MathJax-Span-24727" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.687em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3375">w</script></span>，转移到状态<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3376-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24728" style="width: 13.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24729"><span class="mo" id="MathJax-Span-24730" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24731" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24732" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-24733" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-24734" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mn" id="MathJax-Span-24735" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24736" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24737" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-24738" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24739" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24740" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-24741" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24742" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24743" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mi" id="MathJax-Span-24744" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-24745" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-24746" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mn" id="MathJax-Span-24747" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24748" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24749" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-24750" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24751" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24752" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-24753" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24754" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3376">(next0[a][w], next1[b][w])</script></span>。<br>那么其实我们在做的事就是求一个自动机的并了。可以看作是一个DAG的并，一条边存在当且仅当这条边在两个DAG中都存在。这个新的自动机中，起始状态为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3377-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24755" style="width: 2.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24756"><span class="mo" id="MathJax-Span-24757" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-24758" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24759" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-24760" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-24761" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3377">(0, 0)</script></span>，接受状态为任意<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3378-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24762" style="width: 8.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.213em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24763"><span class="mo" id="MathJax-Span-24764" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24765" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24766" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-24767" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-24768" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24769" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24770" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-24771" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-24772" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-24773" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-24774" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3378">(i \ne -1, j \ne -1)</script></span>。</p><h3 id="3-最小字典序公共子序列"><a name="3-最小字典序公共子序列" href="#3-最小字典序公共子序列"></a>3 最小字典序公共子序列</h3><p>给定两个串，求它们的字典序最小的公共子序列。<br>在合并了的自动机中，每次按照最小字典序走。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3379-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24775" style="width: 6.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.137em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24776"><span class="mi" id="MathJax-Span-24777" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24778" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24779" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-24780"><span class="mrow" id="MathJax-Span-24781"><span class="mo" id="MathJax-Span-24782" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24783" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24784" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24785" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24786" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24787" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24788"><span class="mrow" id="MathJax-Span-24789"><span class="mo" id="MathJax-Span-24790" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24791" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3379">O(n|alpha|)</script></span>。</p><h3 id="4-公共子序列计数（fjoi2016）"><a name="4-公共子序列计数（fjoi2016）" href="#4-公共子序列计数（fjoi2016）"></a>4 公共子序列计数（FJOI2016）</h3><p>给定两个串，求它们的所有公共子序列个数。<br>我们就在这个新的DAG中做路径条数的DP即可。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3380-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24792" style="width: 9.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.596em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24793"><span class="mi" id="MathJax-Span-24794" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24795" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-24796"><span class="mrow" id="MathJax-Span-24797"><span class="mo" id="MathJax-Span-24798" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24799" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24800" style="font-family: MathJax_Main;">0</span><span class="texatom" id="MathJax-Span-24801"><span class="mrow" id="MathJax-Span-24802"><span class="mo" id="MathJax-Span-24803" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-24804"><span class="mrow" id="MathJax-Span-24805"><span class="mo" id="MathJax-Span-24806" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24807" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24808" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-24809"><span class="mrow" id="MathJax-Span-24810"><span class="mo" id="MathJax-Span-24811" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-24812"><span class="mrow" id="MathJax-Span-24813"><span class="mo" id="MathJax-Span-24814" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24815" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24816" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24817" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24818" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24819" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24820"><span class="mrow" id="MathJax-Span-24821"><span class="mo" id="MathJax-Span-24822" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24823" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3380">O(|s0||s1||alpha|)</script></span>。<br> ”可是这个复杂度过不了啊？“<br>注意到一个状态<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3381-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24824" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24825"><span class="mo" id="MathJax-Span-24826" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24827" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24828" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24829" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-24830" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3381">(i, j)</script></span>存在，当且仅当<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3382-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24831" style="width: 5.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.153em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 3.19em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24832"><span class="mi" id="MathJax-Span-24833" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="msubsup" id="MathJax-Span-24834"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.453em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-24835" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-24836" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24837" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-24838" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="msubsup" id="MathJax-Span-24839"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-24840" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-24841" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.305em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3382">s0_i = s1_j</script></span>，因此实际状态数不会超过相等的位置对数。<br>并且若<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3383-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24842" style="width: 4.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.279em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24843"><span class="mi" id="MathJax-Span-24844" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24845" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24846" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-24847" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mn" id="MathJax-Span-24848" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3383">s0 = s1</script></span>且<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3384-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24849" style="width: 9.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.869em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24850"><span class="mi" id="MathJax-Span-24851" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24852" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24853" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-24854" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mi" id="MathJax-Span-24855" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24856" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24857" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-24858" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-24859" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24860" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-24861" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">a</span><span class="mi" id="MathJax-Span-24862" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24863" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24864" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3384">s0 = aaaa...aaaa</script></span>，这样的状态数只有<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3385-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24865" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24866"><span class="mi" id="MathJax-Span-24867" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3385">n</script></span>个，因为初始状态为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3386-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24868" style="width: 2.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24869"><span class="mo" id="MathJax-Span-24870" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-24871" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24872" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-24873" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-24874" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3386">(0, 0)</script></span>，且位置<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3387-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24875" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24876"><span class="mo" id="MathJax-Span-24877" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24878" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24879" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24880" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-24881" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3387">(i, j)</script></span>只会转移到<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3388-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24882" style="width: 6.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.41em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24883"><span class="mo" id="MathJax-Span-24884" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24885" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24886" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-24887" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-24888" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24889" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-24890" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-24891" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-24892" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3388">(i + 1, j + 1)</script></span>或空。<br>唯一能卡到接近上界的是一种随机的01串，不过这样相等对数也大概为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3389-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24893" style="width: 1.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.475em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.234em 1000em 2.686em -0.492em); top: -2.131em; left: 0em;"><span class="mrow" id="MathJax-Span-24894"><span class="mfrac" id="MathJax-Span-24895"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -2.661em; left: 50%; margin-left: -0.546em;"><span class="mrow" id="MathJax-Span-24896"><span class="mi" id="MathJax-Span-24897" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24898" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.652em 1000em 2.459em -0.472em); top: -1.904em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-24899" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.213em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.131em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.505em; vertical-align: -0.544em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3389">nm\over 4</script></span>。<br>为了能只取有效状态，避免扩展无效状态，大力资磁用<strong>记忆化搜索</strong>实现DP。</p><h3 id="5-最长公共子序列"><a name="5-最长公共子序列" href="#5-最长公共子序列"></a>5 最长公共子序列</h3><p>给你两个串，求它们的最长公共子序列。<br>转化为DAG之后，我们要求的就是DAG最长路。仍然是熟知的DAG上DP。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3390-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24900" style="width: 9.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.596em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24901"><span class="mi" id="MathJax-Span-24902" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24903" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-24904"><span class="mrow" id="MathJax-Span-24905"><span class="mo" id="MathJax-Span-24906" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24907" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24908" style="font-family: MathJax_Main;">0</span><span class="texatom" id="MathJax-Span-24909"><span class="mrow" id="MathJax-Span-24910"><span class="mo" id="MathJax-Span-24911" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-24912"><span class="mrow" id="MathJax-Span-24913"><span class="mo" id="MathJax-Span-24914" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24915" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-24916" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-24917"><span class="mrow" id="MathJax-Span-24918"><span class="mo" id="MathJax-Span-24919" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-24920"><span class="mrow" id="MathJax-Span-24921"><span class="mo" id="MathJax-Span-24922" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24923" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24924" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24925" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24926" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24927" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24928"><span class="mrow" id="MathJax-Span-24929"><span class="mo" id="MathJax-Span-24930" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-24931" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3390">O(|s0||s1||alpha|)</script></span>。<br>这个时间复杂度是劣于经典做法的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3391-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24932" style="width: 3.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.06em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24933"><span class="mi" id="MathJax-Span-24934" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-24935" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24936" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24937" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-24938" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3391">O(nm)</script></span>。但注意到相等对数的限制，实际的状态数其实很少，记忆化搜索的运行时间往往快于经典做法。但仍然要注意这个算法只能胜任<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3392-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24939" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24940"><span class="texatom" id="MathJax-Span-24941"><span class="mrow" id="MathJax-Span-24942"><span class="mo" id="MathJax-Span-24943" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-24944" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24945" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-24946" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-24947" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-24948" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-24949"><span class="mrow" id="MathJax-Span-24950"><span class="mo" id="MathJax-Span-24951" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.352em; vertical-align: -0.37em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3392">|alpha|</script></span>不大的情况。</p><h3 id="6-带单串作为子序列包含约束的lis（fjoi2013）"><a name="6-带单串作为子序列包含约束的lis（fjoi2013）" href="#6-带单串作为子序列包含约束的lis（fjoi2013）"></a>6 带单串作为子序列包含约束的LIS（FJOI2013）</h3><p>给三个串<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3393-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24952" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24953"><span class="mi" id="MathJax-Span-24954" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3393">A</script></span>、<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3394-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24955" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24956"><span class="mi" id="MathJax-Span-24957" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3394">B</script></span>、<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3395-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24958" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.442em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24959"><span class="mi" id="MathJax-Span-24960" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3395">C</script></span>，求一个最长的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3396-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24961" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24962"><span class="mi" id="MathJax-Span-24963" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3396">A</script></span>、<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3397-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24964" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24965"><span class="mi" id="MathJax-Span-24966" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3397">B</script></span>的公共子序列<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3398-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24967" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24968"><span class="mi" id="MathJax-Span-24969" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3398">s</script></span>，要求<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3399-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24970" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.442em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24971"><span class="mi" id="MathJax-Span-24972" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3399">C</script></span>是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3400-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24973" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24974"><span class="mi" id="MathJax-Span-24975" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3400">s</script></span>的子序列。<br>这时，如果只记录二元组<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3401-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24976" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24977"><span class="mo" id="MathJax-Span-24978" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24979" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24980" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24981" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-24982" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3401">(i, j)</script></span>是不行的，我们考虑仍然用自动机识别“包含<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3402-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24983" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24984"><span class="mi" id="MathJax-Span-24985" style="font-family: MathJax_Math; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3402">c</script></span>作为子序列”的串。<br>这个自动机的构造也相当显然。设<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3403-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24986" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24987"><span class="mi" id="MathJax-Span-24988" style="font-family: MathJax_Math; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3403">c</script></span>为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3404-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24989" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.442em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24990"><span class="mi" id="MathJax-Span-24991" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3404">C</script></span>串的这种自动机的转移函数，则：</p><ul>
<li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3405-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24992" style="width: 8.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.268em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24993"><span class="mi" id="MathJax-Span-24994" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-24995" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24996" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24997" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-24998" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-24999" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-25000" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="msubsup" id="MathJax-Span-25001" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.943em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.442em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25002" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.72em;"><span class="texatom" id="MathJax-Span-25003"><span class="mrow" id="MathJax-Span-25004"><span class="mi" id="MathJax-Span-25005" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25006" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-25007" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-25008" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-25009" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25010" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3405">c[i][j \ne C_{i+1}] = i</script></span></li><li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3406-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25011" style="width: 8.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.213em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25012"><span class="mi" id="MathJax-Span-25013" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-25014" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-25015" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25016" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-25017" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-25018"><span style="display: inline-block; position: relative; width: 1.943em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.442em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25019" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.72em;"><span class="texatom" id="MathJax-Span-25020"><span class="mrow" id="MathJax-Span-25021"><span class="mi" id="MathJax-Span-25022" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25023" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-25024" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-25025" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-25026" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25027" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mo" id="MathJax-Span-25028" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-25029" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3406">c[i][C_{i+1}] = i + 1</script></span></li><li>起始状态为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3407-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25030" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.453em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25031"><span class="mn" id="MathJax-Span-25032" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3407">0</script></span>，接受状态仅为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3408-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25033" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25034"><span class="texatom" id="MathJax-Span-25035"><span class="mrow" id="MathJax-Span-25036"><span class="mo" id="MathJax-Span-25037" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25038" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="texatom" id="MathJax-Span-25039"><span class="mrow" id="MathJax-Span-25040"><span class="mo" id="MathJax-Span-25041" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.352em; vertical-align: -0.37em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3408">|c|</script></span></li></ul><p>然后，我们利用三元组<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3775-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28992" style="width: 3.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.951em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-28993"><span class="mo" id="MathJax-Span-28994" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-28995" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28996" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-28997" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-28998" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-28999" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">k</span><span class="mo" id="MathJax-Span-29000" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3775">(i, j, k)</script></span>记录状态，则我们要求的是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3776-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29001" style="width: 3.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.169em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29002"><span class="mo" id="MathJax-Span-29003" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-29004" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-29005" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-29006" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-29007" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-29008" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-29009" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3776">(0, 0, 0)</script></span>到任意形如<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3777-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29010" style="width: 10.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.634em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29011"><span class="mo" id="MathJax-Span-29012" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29013" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29014" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-29015" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-29016" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-29017" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29018" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29019" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-29020" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-29021" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-29022" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-29023" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-29024"><span class="mo" id="MathJax-Span-29025" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29026" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="texatom" id="MathJax-Span-29027"><span class="mrow" id="MathJax-Span-29028"><span class="mo" id="MathJax-Span-29029" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29030" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3777">(i \ne -1, j \ne -1, |c|)</script></span>的节点的最长路。DP！<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3778-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29031" style="width: 10.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.47em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29032"><span class="mi" id="MathJax-Span-29033" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29034" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-29035"><span class="mrow" id="MathJax-Span-29036"><span class="mo" id="MathJax-Span-29037" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29038" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="texatom" id="MathJax-Span-29039"><span class="mrow" id="MathJax-Span-29040"><span class="mo" id="MathJax-Span-29041" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-29042"><span class="mrow" id="MathJax-Span-29043"><span class="mo" id="MathJax-Span-29044" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29045" style="font-family: MathJax_Math; font-style: italic;">B</span><span class="texatom" id="MathJax-Span-29046"><span class="mrow" id="MathJax-Span-29047"><span class="mo" id="MathJax-Span-29048" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-29049"><span class="mrow" id="MathJax-Span-29050"><span class="mo" id="MathJax-Span-29051" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29052" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="texatom" id="MathJax-Span-29053"><span class="mrow" id="MathJax-Span-29054"><span class="mo" id="MathJax-Span-29055" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-29056"><span class="mrow" id="MathJax-Span-29057"><span class="mo" id="MathJax-Span-29058" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29059" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29060" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29061" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29062" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29063" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29064"><span class="mrow" id="MathJax-Span-29065"><span class="mo" id="MathJax-Span-29066" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29067" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3778">O(|A||B||C||alpha|)</script></span>。<br>同样存在严格<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3779-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29068" style="width: 6.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.519em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29069"><span class="mi" id="MathJax-Span-29070" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29071" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-29072"><span class="mrow" id="MathJax-Span-29073"><span class="mo" id="MathJax-Span-29074" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29075" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="texatom" id="MathJax-Span-29076"><span class="mrow" id="MathJax-Span-29077"><span class="mo" id="MathJax-Span-29078" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-29079"><span class="mrow" id="MathJax-Span-29080"><span class="mo" id="MathJax-Span-29081" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29082" style="font-family: MathJax_Math; font-style: italic;">B</span><span class="texatom" id="MathJax-Span-29083"><span class="mrow" id="MathJax-Span-29084"><span class="mo" id="MathJax-Span-29085" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-29086"><span class="mrow" id="MathJax-Span-29087"><span class="mo" id="MathJax-Span-29088" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29089" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="texatom" id="MathJax-Span-29090"><span class="mrow" id="MathJax-Span-29091"><span class="mo" id="MathJax-Span-29092" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29093" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3779">O(|A||B||C|)</script></span>的经典算法，但仍然由于状态合法性的原因只比此算法快<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3780-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29094" style="width: 2.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.858em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 2.952em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29095"><span class="mn" id="MathJax-Span-29096" style="font-family: MathJax_Main;">14</span><span class="mi" id="MathJax-Span-29097" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.117em; vertical-align: -0.135em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3780">14\%</script></span>。并且只有此算法可以推广到这个问题的计数版本。</p><h3 id="7-最短不公共子序列（heoi2015）"><a name="7-最短不公共子序列（heoi2015）" href="#7-最短不公共子序列（heoi2015）"></a>7 最短不公共子序列（HEOI2015）</h3><p>给定<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3415-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25148" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25149"><span class="mi" id="MathJax-Span-25150" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3415">A</script></span>、<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3416-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25151" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25152"><span class="mi" id="MathJax-Span-25153" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3416">B</script></span>两个串串，求：</p><ul>
<li>一个最短的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3417-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25154" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25155"><span class="mi" id="MathJax-Span-25156" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3417">A</script></span>的子串，不是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3418-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25157" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25158"><span class="mi" id="MathJax-Span-25159" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3418">B</script></span>的子串</li><li>一个最短的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3419-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25160" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25161"><span class="mi" id="MathJax-Span-25162" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3419">A</script></span>的子序列，不是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3420-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25163" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25164"><span class="mi" id="MathJax-Span-25165" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3420">B</script></span>的子串</li><li>一个最短的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3421-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25166" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25167"><span class="mi" id="MathJax-Span-25168" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3421">A</script></span>的子串，不是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3422-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25169" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25170"><span class="mi" id="MathJax-Span-25171" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3422">B</script></span>的子序列</li><li>一个最短的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3423-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25172" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.634em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25173"><span class="mi" id="MathJax-Span-25174" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3423">A</script></span>的子序列，不是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3424-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25175" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25176"><span class="mi" id="MathJax-Span-25177" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3424">B</script></span>的子序列</li></ul><p>先考虑第4个子问题。如果仍用二元组记录，那么这样的接受状态就是任意<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3425-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25178" style="width: 6.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25179"><span class="mo" id="MathJax-Span-25180" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25181" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25182" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-25183" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-25184" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-25185" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-25186" style="font-family: MathJax_Main; padding-left: 0.167em;">−</span><span class="mn" id="MathJax-Span-25187" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-25188" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3425">(i \ne -1, -1)</script></span>，而我们的答案就是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3426-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25189" style="width: 2.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25190"><span class="mo" id="MathJax-Span-25191" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-25192" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-25193" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-25194" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-25195" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3426">(0,0)</script></span>到任意这样点的最短路。因此构造出两个串的next数组，就可以利用BFS求出答案。这样同样不会扩展到不必要的状态。<br>考虑其他子问题。能接受所有子串的自动机就是后缀自动机（并把所有节点标记为接受），那么我们就可以推广到一个一般的问题：给出两个自动机，求出被第一个自动机接受而不被第二个自动机接受的最短串。显然上面那个方法可以推广，因此这个问题就这样被解决了。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3427-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25196" style="width: 8.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.158em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25197"><span class="mi" id="MathJax-Span-25198" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-25199" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-25200"><span class="mrow" id="MathJax-Span-25201"><span class="mo" id="MathJax-Span-25202" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25203" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="texatom" id="MathJax-Span-25204"><span class="mrow" id="MathJax-Span-25205"><span class="mo" id="MathJax-Span-25206" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-25207"><span class="mrow" id="MathJax-Span-25208"><span class="mo" id="MathJax-Span-25209" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25210" style="font-family: MathJax_Math; font-style: italic;">B</span><span class="texatom" id="MathJax-Span-25211"><span class="mrow" id="MathJax-Span-25212"><span class="mo" id="MathJax-Span-25213" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-25214"><span class="mrow" id="MathJax-Span-25215"><span class="mo" id="MathJax-Span-25216" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25217" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-25218" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-25219" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-25220" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-25221" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25222"><span class="mrow" id="MathJax-Span-25223"><span class="mo" id="MathJax-Span-25224" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-25225" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3427">O(|A||B||alpha|)</script></span>。<br>这个算法同样可以被推广到这一类计数问题上</p><h3 id="8-多个串的公共子序列"><a name="8-多个串的公共子序列" href="#8-多个串的公共子序列"></a>8 多个串的公共子序列</h3><p>给出<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3428-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25226" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25227"><span class="mi" id="MathJax-Span-25228" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3428">k</script></span>个串<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3429-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25229" style="width: 3.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.126em 1000em 3.054em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25230"><span class="msubsup" id="MathJax-Span-25231"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25232" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mn" id="MathJax-Span-25233" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-25234" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-25235" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-25236" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="msubsup" id="MathJax-Span-25237" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25238" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-25239" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3429">s_1...s_k</script></span>，求出它们的最长公共子序列和不同的公共子序列个数。<br>既然我们能做2个串，我们就也能做k个串：把k个自动机合并起来就OK了。但复杂度不是很优美，也没有什么好的替代方法。<br>注意到多个串会导致有效状态数大大减小，因此可以用记忆化搜索和哈希表来保存状态。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3430-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25240" style="width: 10.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.47em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.601em 1000em 3.189em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25241"><span class="mi" id="MathJax-Span-25242" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-25243" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-25244"><span class="mrow" id="MathJax-Span-25245"><span class="mo" id="MathJax-Span-25246" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25247" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-25248" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-25249" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-25250" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-25251" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25252"><span class="mrow" id="MathJax-Span-25253"><span class="mo" id="MathJax-Span-25254" style="font-family: MathJax_Main;">|</span></span></span><span class="munderover" id="MathJax-Span-25255" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.206em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25256" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.412em -0.458em); top: -2.717em; left: 0.984em;"><span class="mi" id="MathJax-Span-25257" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -2.01em; left: 0.984em;"><span class="texatom" id="MathJax-Span-25258"><span class="mrow" id="MathJax-Span-25259"><span class="mi" id="MathJax-Span-25260" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25261" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-25262" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25263" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25264"><span class="mo" id="MathJax-Span-25265" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-25266"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25267" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-25268" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25269"><span class="mrow" id="MathJax-Span-25270"><span class="mo" id="MathJax-Span-25271" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-25272" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.672em; vertical-align: -0.424em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3430">O(|alpha|\prod_{i=1}^k |s_i|)</script></span>。<br>如果加入“至少是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3431-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25273" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25274"><span class="mi" id="MathJax-Span-25275" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3431">k</script></span>个串的公共子序列”这一约束，则我们可以允许状态中存在不少于<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3432-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25276" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25277"><span class="mi" id="MathJax-Span-25278" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3432">k</script></span>个非0位置。复杂度不变。</p><h3 id="9-两个串带多串作为子串包含的公共子序列（fjoi2015）"><a name="9-两个串带多串作为子串包含的公共子序列（fjoi2015）" href="#9-两个串带多串作为子串包含的公共子序列（fjoi2015）"></a>9 两个串带多串作为子串包含的公共子序列（FJOI2015）</h3><p>给出两个串<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3433-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25279" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.09em -0.459em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25280"><span class="mi" id="MathJax-Span-25281" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-25282" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-25283" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.217em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3433">a,b</script></span>，再给出<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3434-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25284" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25285"><span class="mi" id="MathJax-Span-25286" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3434">k</script></span>个串<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3435-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25287" style="width: 3.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.896em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.054em -0.454em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25288"><span class="msubsup" id="MathJax-Span-25289"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25290" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.328em;"><span class="mn" id="MathJax-Span-25291" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-25292" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-25293" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-25294" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="msubsup" id="MathJax-Span-25295" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25296" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.328em;"><span class="mi" id="MathJax-Span-25297" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.173em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3435">l_1...l_k</script></span>，要求求出一个最长的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3436-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25298" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.09em -0.459em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25299"><span class="mi" id="MathJax-Span-25300" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-25301" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-25302" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.217em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3436">a,b</script></span>的公共在序列<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3437-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25303" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25304"><span class="mi" id="MathJax-Span-25305" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3437">s</script></span>，使得所有<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3438-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25306" style="width: 0.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.273em 1000em 2.453em -0.454em); top: -2.131em; left: 0em;"><span class="mrow" id="MathJax-Span-25307"><span class="msubsup" id="MathJax-Span-25308"><span style="display: inline-block; position: relative; width: 0.676em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25309" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.328em;"><span class="mi" id="MathJax-Span-25310" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.131em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.173em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3438">l_i</script></span>是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3439-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25311" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25312"><span class="mi" id="MathJax-Span-25313" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3439">s</script></span>的子串。<br>解决子串问题需要用到AC自动机，由于这里需要是所有串的子串，我们还得记录一个<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3440-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25314" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.084em 1000em 2.295em -0.442em); top: -2.131em; left: 0em;"><span class="mrow" id="MathJax-Span-25315"><span class="msubsup" id="MathJax-Span-25316"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-25317" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.633em; left: 0.546em;"><span class="mi" id="MathJax-Span-25318" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.131em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.211em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3440">2^k</script></span>的状压。这样我们就为限制建了一个状态数为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3441-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25319" style="width: 6.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.918em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.601em 1000em 3.189em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25320"><span class="msubsup" id="MathJax-Span-25321"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-25322" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.633em; left: 0.546em;"><span class="mi" id="MathJax-Span-25323" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="munderover" id="MathJax-Span-25324" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25325" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.412em -0.458em); top: -2.717em; left: 1.093em;"><span class="mi" id="MathJax-Span-25326" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -2.01em; left: 1.093em;"><span class="texatom" id="MathJax-Span-25327"><span class="mrow" id="MathJax-Span-25328"><span class="mi" id="MathJax-Span-25329" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25330" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-25331" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25332" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25333"><span class="mo" id="MathJax-Span-25334" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-25335"><span style="display: inline-block; position: relative; width: 0.676em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25336" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.328em;"><span class="mi" id="MathJax-Span-25337" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25338"><span class="mrow" id="MathJax-Span-25339"><span class="mo" id="MathJax-Span-25340" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.672em; vertical-align: -0.424em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3441">2^k\sum_{i=1}^k |l_i|</script></span>的自动机，状态形如<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3442-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25341" style="width: 6.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.574em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.685em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25342"><span class="mo" id="MathJax-Span-25343" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-25344"><span class="mrow" id="MathJax-Span-25345"><span class="mo" id="MathJax-Span-25346"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">节</span></span></span></span><span class="texatom" id="MathJax-Span-25347"><span class="mrow" id="MathJax-Span-25348"><span class="mo" id="MathJax-Span-25349"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">点</span></span></span></span><span class="texatom" id="MathJax-Span-25350"><span class="mrow" id="MathJax-Span-25351"><span class="mo" id="MathJax-Span-25352"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">，</span></span></span></span><span class="msubsup" id="MathJax-Span-25353"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.453em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-25354" style="font-family: MathJax_Main;">0...2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.633em; left: 1.858em;"><span class="mi" id="MathJax-Span-25355" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25356" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.516em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3442">(节点，0...2^k)</script></span>。把它和<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3443-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25357" style="width: 2.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.803em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.55em 1000em 2.878em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25358"><span class="mi" id="MathJax-Span-25359" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25360"><span class="mrow" id="MathJax-Span-25361"><span class="mo" id="MathJax-Span-25362"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">、</span></span></span></span><span class="mi" id="MathJax-Span-25363" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3443">a、b</script></span>的next数组放在一起DP即可（求<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3444-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25364" style="width: 5.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.153em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25365"><span class="mo" id="MathJax-Span-25366" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-25367" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-25368" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-25369" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-25370" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-25371" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-25372" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-25373" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-25374" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3444">(0, 0, 0, 0)</script></span>到任意<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3445-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25375" style="width: 11.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.563em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.685em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25376"><span class="mo" id="MathJax-Span-25377" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25378" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25379" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-25380" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-25381" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-25382" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-25383" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-25384" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-25385" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-25386" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-25387" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-25388" style="font-family: MathJax_Main; padding-left: 0.167em;">∗</span><span class="mo" id="MathJax-Span-25389" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-25390" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-25391" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.633em; left: 0.546em;"><span class="mi" id="MathJax-Span-25392" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25393" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.516em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3445">(i \ne -1, j \ne -1, *, 2^k)</script></span>的最长路）。<br>这题的状态相当多，因此我们仍然需要记忆化+哈希存状态。除此之外，我们还可以加一些剪枝，比如如果当前长度就算后面忽略了限制都无法超过答案，就停止扩展此状态。另一个剪枝就是预处理<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3446-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25394" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.459em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25395"><span class="mi" id="MathJax-Span-25396" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-25397" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-25398" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25399" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-25400" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-25401" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="texatom" id="MathJax-Span-25402" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25403"><span class="mo" id="MathJax-Span-25404" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25405" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25406"><span class="mrow" id="MathJax-Span-25407"><span class="mo" id="MathJax-Span-25408" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-25409" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3446">a[i...|a|]</script></span>和<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3447-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25410" style="width: 4.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.279em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.452em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25411"><span class="mi" id="MathJax-Span-25412" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-25413" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-25414" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-25415" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-25416" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="texatom" id="MathJax-Span-25417" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25418"><span class="mo" id="MathJax-Span-25419" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25420" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="texatom" id="MathJax-Span-25421"><span class="mrow" id="MathJax-Span-25422"><span class="mo" id="MathJax-Span-25423" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-25424" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3447">b[j..|b|]</script></span>的LIS，在所有限制都满足的时候直接取用，但其实记忆化就已经暗藏了这个剪枝。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3448-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25425" style="width: 20.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.94em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.601em 1000em 3.189em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25426"><span class="mi" id="MathJax-Span-25427" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-25428" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-25429" style="font-family: MathJax_Main;">min</span><span class="mo" id="MathJax-Span-25430" style="font-family: MathJax_Main;">{</span><span class="texatom" id="MathJax-Span-25431"><span class="mrow" id="MathJax-Span-25432"><span class="mo" id="MathJax-Span-25433" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25434" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25435"><span class="mrow" id="MathJax-Span-25436"><span class="mo" id="MathJax-Span-25437" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-25438"><span class="mrow" id="MathJax-Span-25439"><span class="mo" id="MathJax-Span-25440" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25441" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="texatom" id="MathJax-Span-25442"><span class="mrow" id="MathJax-Span-25443"><span class="mo" id="MathJax-Span-25444" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-25445"><span class="mrow" id="MathJax-Span-25446"><span class="mo" id="MathJax-Span-25447" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-25448"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mn" id="MathJax-Span-25449" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.633em; left: 0.546em;"><span class="mi" id="MathJax-Span-25450" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25451"><span class="mrow" id="MathJax-Span-25452"><span class="mo" id="MathJax-Span-25453" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-25454"><span class="mrow" id="MathJax-Span-25455"><span class="mo" id="MathJax-Span-25456" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25457" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-25458" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-25459" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-25460" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-25461" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25462"><span class="mrow" id="MathJax-Span-25463"><span class="mo" id="MathJax-Span-25464" style="font-family: MathJax_Main;">|</span></span></span><span class="munderover" id="MathJax-Span-25465" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25466" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.412em -0.458em); top: -2.717em; left: 1.093em;"><span class="mi" id="MathJax-Span-25467" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -2.01em; left: 1.093em;"><span class="texatom" id="MathJax-Span-25468"><span class="mrow" id="MathJax-Span-25469"><span class="mi" id="MathJax-Span-25470" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25471" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-25472" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25473" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25474"><span class="mo" id="MathJax-Span-25475" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-25476"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25477" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-25478" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25479"><span class="mrow" id="MathJax-Span-25480"><span class="mo" id="MathJax-Span-25481" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-25482" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-25483" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25484"><span class="mo" id="MathJax-Span-25485"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">玄</span></span></span></span><span class="texatom" id="MathJax-Span-25486"><span class="mrow" id="MathJax-Span-25487"><span class="mo" id="MathJax-Span-25488"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">学</span></span></span></span><span class="mo" id="MathJax-Span-25489" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-25490" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.672em; vertical-align: -0.424em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3448">O(\min\{|a||b||2^k||alpha|\sum_{i=1}^k |s_i|,玄学\})</script></span>。<br>如果转为计数问题，就不能加最优性剪枝。</p><h3 id="10-多个串的公共上升子序列"><a name="10-多个串的公共上升子序列" href="#10-多个串的公共上升子序列"></a>10 多个串的公共上升子序列</h3><p>给出<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3449-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25491" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25492"><span class="mi" id="MathJax-Span-25493" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3449">k</script></span>个串<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3450-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25494" style="width: 3.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.842em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 2.907em -0.439em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25495"><span class="mi" id="MathJax-Span-25496" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mn" id="MathJax-Span-25497" style="font-family: MathJax_Main;">1...</span><span class="mi" id="MathJax-Span-25498" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-25499" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3450">s1...sk</script></span>，求出它们的最长公共上升子序列和公共上升子序列的个数。<br>同样可以使用上升序列自动机的组合进行DP。如果字符集太大，需要离散化字符集。<br>我们知道对于<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3451-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25500" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 2.907em -0.444em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25501"><span class="mi" id="MathJax-Span-25502" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-25503" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-25504" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3451">k=2</script></span>的情况有一个<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3452-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25505" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.623em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.734em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25506"><span class="mi" id="MathJax-Span-25507" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-25508" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25509"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25510" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.658em; left: 0.601em;"><span class="mn" id="MathJax-Span-25511" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-25512" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.456em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3452">O(n^2)</script></span>的求LCIS的算法（YZOJ1235），可以推广到更多串的情况，但有且仅有借助了next数组的方法可以进行计数。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3453-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25513" style="width: 10.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.601em 1000em 3.189em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25514"><span class="mi" id="MathJax-Span-25515" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-25516" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-25517"><span class="mrow" id="MathJax-Span-25518"><span class="mo" id="MathJax-Span-25519" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25520" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-25521" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-25522" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-25523" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-25524" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-25525"><span class="mrow" id="MathJax-Span-25526"><span class="mo" id="MathJax-Span-25527" style="font-family: MathJax_Main;">|</span></span></span><span class="munderover" id="MathJax-Span-25528" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25529" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.412em -0.458em); top: -2.717em; left: 1.093em;"><span class="mi" id="MathJax-Span-25530" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -2.01em; left: 1.093em;"><span class="texatom" id="MathJax-Span-25531"><span class="mrow" id="MathJax-Span-25532"><span class="mi" id="MathJax-Span-25533" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-25534" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-25535" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="texatom" id="MathJax-Span-25536" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-25537"><span class="mo" id="MathJax-Span-25538" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-25539" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-25540" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="texatom" id="MathJax-Span-25541"><span class="mrow" id="MathJax-Span-25542"><span class="mo" id="MathJax-Span-25543" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-25544" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.672em; vertical-align: -0.424em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3453">O(|alpha|\sum_{i=1}^k |si|)</script></span>。</p><h3 id="11-回文子序列计数"><a name="11-回文子序列计数" href="#11-回文子序列计数"></a>11 回文子序列计数</h3><p>给出一个串，求其不同回文子序列个数。<br>考虑从左右两端构造回文串。构造原串及反串的序列自动机，DP。<br>对于状态<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4025-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31134" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-31135"><span class="mo" id="MathJax-Span-31136" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-31137" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31138" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-31139" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-31140" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4025">(i, j)</script></span>，若<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4026-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31141" style="width: 4.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.934em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.907em 1000em 3.1em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-31142"><span class="mi" id="MathJax-Span-31143" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31144" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-31145" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">j</span><span class="mo" id="MathJax-Span-31146" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-31147" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.189em; vertical-align: -0.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4026">i+j\le n</script></span>，则此状态能表示一个长度为偶数的回文串；若<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4027-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31148" style="width: 6.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 3.1em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-31149"><span class="mi" id="MathJax-Span-31150" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31151" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-31152" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">j</span><span class="mo" id="MathJax-Span-31153" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-31154" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-31155" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-31156" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.195em; vertical-align: -0.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4027">i+j-1\le n</script></span>，则能表示一个长度为奇数的回文串。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4028-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31157" style="width: 6.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.734em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-31158"><span class="mi" id="MathJax-Span-31159" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-31160" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-31161"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-31162" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.658em; left: 0.601em;"><span class="mn" id="MathJax-Span-31163" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="texatom" id="MathJax-Span-31164"><span class="mrow" id="MathJax-Span-31165"><span class="mo" id="MathJax-Span-31166" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-31167" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-31168" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-31169" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-31170" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-31171" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-31172"><span class="mrow" id="MathJax-Span-31173"><span class="mo" id="MathJax-Span-31174" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-31175" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.456em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4028">O(n^2|alpha|)</script></span>。</p><h2 id="字典序及长度相关"><a name="字典序及长度相关" href="#字典序及长度相关"></a>字典序及长度相关</h2><p>作为自动机，next数组解决字典序问题是浑然天成的。同样，增加一维状态表示长度也可以用来做和长度有关的题目。</p><h3 id="12-子序列长度之和"><a name="12-子序列长度之和" href="#12-子序列长度之和"></a>12 子序列长度之和</h3><p>给出一个串，求其所有不同的子序列长度之和。<br>一个比较naive的做法，就是增加长度这一维，把状态记为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3817-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29477" style="width: 5.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.536em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.768em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29478"><span class="mo" id="MathJax-Span-29479" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-29480"><span class="mrow" id="MathJax-Span-29481"><span class="mo" id="MathJax-Span-29482"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">位</span></span></span></span><span class="texatom" id="MathJax-Span-29483"><span class="mrow" id="MathJax-Span-29484"><span class="mo" id="MathJax-Span-29485"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">置</span></span></span></span><span class="mo" id="MathJax-Span-29486" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-29487" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-29488"><span class="mo" id="MathJax-Span-29489"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">长</span></span></span></span><span class="texatom" id="MathJax-Span-29490"><span class="mrow" id="MathJax-Span-29491"><span class="mo" id="MathJax-Span-29492"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">度</span></span></span></span><span class="mo" id="MathJax-Span-29493" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.414em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3817">(位置, 长度)</script></span>，则答案就是每个状态的出现次数乘上长度之和。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3818-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29494" style="width: 6.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.734em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29495"><span class="mi" id="MathJax-Span-29496" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29497" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-29498"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-29499" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.658em; left: 0.601em;"><span class="mn" id="MathJax-Span-29500" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="texatom" id="MathJax-Span-29501"><span class="mrow" id="MathJax-Span-29502"><span class="mo" id="MathJax-Span-29503" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29504" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29505" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29506" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29507" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29508" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29509"><span class="mrow" id="MathJax-Span-29510"><span class="mo" id="MathJax-Span-29511" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29512" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.456em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3818">O(n^2|alpha|)</script></span>。<br>考虑转化为DAG模型，则答案就是每条边走的次数之和乘上边长（这里都是1）。假设当前在节点i，且以next[i][w]开头的串的个数为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3819-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29513" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29514"><span class="mi" id="MathJax-Span-29515" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3819">x</script></span>，那么就有<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3820-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29516" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29517"><span class="mi" id="MathJax-Span-29518" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3820">x</script></span>个不同的子串经过next[i][w]。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3821-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29519" style="width: 6.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.137em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29520"><span class="mi" id="MathJax-Span-29521" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29522" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29523" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-29524"><span class="mrow" id="MathJax-Span-29525"><span class="mo" id="MathJax-Span-29526" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29527" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29528" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29529" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29530" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29531" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29532"><span class="mrow" id="MathJax-Span-29533"><span class="mo" id="MathJax-Span-29534" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29535" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3821">O(n|alpha|)</script></span></p><h3 id="13-长度区间范围内计数"><a name="13-长度区间范围内计数" href="#13-长度区间范围内计数"></a>13 长度区间范围内计数</h3><p>给出一个串，求其长度在<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3822-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29536" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29537"><span class="mo" id="MathJax-Span-29538" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29539" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-29540" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29541" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">r</span><span class="mo" id="MathJax-Span-29542" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3822">[l, r]</script></span>内的不同子序列个数。<br>这下就必须记录长度作为一维状态了。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3823-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29543" style="width: 4.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.934em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29544"><span class="mi" id="MathJax-Span-29545" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29546" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29547" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-29548" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="texatom" id="MathJax-Span-29549"><span class="mrow" id="MathJax-Span-29550"><span class="mo" id="MathJax-Span-29551" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29552" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="texatom" id="MathJax-Span-29553"><span class="mrow" id="MathJax-Span-29554"><span class="mo" id="MathJax-Span-29555" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29556" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3823">O(nr|A|)</script></span>。</p><h3 id="14-长度范围内最小字典序子序列"><a name="14-长度范围内最小字典序子序列" href="#14-长度范围内最小字典序子序列"></a>14 长度范围内最小字典序子序列</h3><p>给出一个串，求其长度在<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3824-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29557" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29558"><span class="mo" id="MathJax-Span-29559" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29560" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-29561" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29562" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">r</span><span class="mo" id="MathJax-Span-29563" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3824">[l, r]</script></span>内的最小字典序子序列。<br>考虑一子序列，它的任意前缀的字典序均比它小，因此<strong><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3825-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29564" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29565"><span class="mi" id="MathJax-Span-29566" style="font-family: MathJax_Math; font-style: italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3825">r</script></span>是没用的</strong>，我们真正的任务是求长度为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3826-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29567" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29568"><span class="mi" id="MathJax-Span-29569" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3826">l</script></span>的最小字典序子序列。<br>考虑当前在节点i，已有长度为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3827-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29570" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29571"><span class="mi" id="MathJax-Span-29572" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.684em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3827">a</script></span>，则下一个节点不能超过<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3828-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29573" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 2.978em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29574"><span class="mi" id="MathJax-Span-29575" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-29576" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-29577" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mo" id="MathJax-Span-29578" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-29579" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.167em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3828">n - l + a</script></span>（否则就算全取满都无法达到<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3829-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29580" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29581"><span class="mi" id="MathJax-Span-29582" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3829">l</script></span>）。由于next数组取的就是（尽量靠前的）下一个位置，因此我们要取的是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3830-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29583" style="width: 23.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.454em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.768em 1000em 3.146em -0.467em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29584"><span class="munderover" id="MathJax-Span-29585"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.896em -0.467em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-29586" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 1.694em;"><span class="mi" id="MathJax-Span-29587" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-29588" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mi" id="MathJax-Span-29589" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-29590" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-29591" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-29592" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29593" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29594" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29595" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29596" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-29597" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29598" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-29599" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-29600" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-29601"><span class="mrow" id="MathJax-Span-29602"><span class="mo" id="MathJax-Span-29603"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">且</span></span></span></span><span class="mi" id="MathJax-Span-29604" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-29605" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-29606" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-29607" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-29608" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29609" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29610" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29611" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29612" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-29613" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29614" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-29615" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span><span class="mo" id="MathJax-Span-29616" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-29617" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mo" id="MathJax-Span-29618" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-29619" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.414em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3830">\min_w next[i][w] \ne  -1 且next[i][w] \le n - l + a</script></span>作为下一个字符。从0开始，按照此规则走<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3831-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29620" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29621"><span class="mi" id="MathJax-Span-29622" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3831">l</script></span>步即可。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3832-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29623" style="width: 9.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.432em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29624"><span class="mi" id="MathJax-Span-29625" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29626" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-29627" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29628" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-29629" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-29630" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mo" id="MathJax-Span-29631" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-29632"><span class="mrow" id="MathJax-Span-29633"><span class="mo" id="MathJax-Span-29634" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29635" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29636" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29637" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29638" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29639" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29640"><span class="mrow" id="MathJax-Span-29641"><span class="mo" id="MathJax-Span-29642" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29643" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3832">O((n+l)|alpha|)</script></span>。</p><h3 id="15-长度范围内最小字典序公共子序列"><a name="15-长度范围内最小字典序公共子序列" href="#15-长度范围内最小字典序公共子序列"></a>15 长度范围内最小字典序公共子序列</h3><p>给出两个串，求一个长度在<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3833-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29644" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29645"><span class="mo" id="MathJax-Span-29646" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29647" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-29648" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29649" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">r</span><span class="mo" id="MathJax-Span-29650" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3833">[l, r]</script></span>内的最小字典序公共子序列。<br>同样，只需考虑限制<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3834-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29651" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29652"><span class="mi" id="MathJax-Span-29653" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3834">l</script></span>。但是我们并不能<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3835-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29654" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.077em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29655"><span class="mi" id="MathJax-Span-29656" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29657" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-29658" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-29659" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3835">O(1)</script></span>得出一个状态<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3836-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29660" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29661"><span class="mo" id="MathJax-Span-29662" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29663" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29664" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29665" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29666" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3836">(i, j)</script></span>能扩展出的最长长度，因此我们需要预处理一些东西。预处理什么呢？<strong>从<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3837-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29667" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29668"><span class="mo" id="MathJax-Span-29669" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29670" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29671" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29672" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29673" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3837">(i, j)</script></span>出发的最长路</strong>！也就是<strong>从<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3838-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29674" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29675"><span class="mo" id="MathJax-Span-29676" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29677" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29678" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29679" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29680" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3838">(i, j)</script></span>开始的最长公共子序列</strong>！<br>设<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3839-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29681" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29682"><span class="mi" id="MathJax-Span-29683" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-29684" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29685" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29686" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29687" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29688" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3839">f(i, j)</script></span>为从<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3840-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29689" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29690"><span class="mo" id="MathJax-Span-29691" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29692" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29693" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29694" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29695" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3840">(i, j)</script></span>出发的最长路，则我们从状态<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3841-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29696" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29697"><span class="mo" id="MathJax-Span-29698" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29699" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29700" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29701" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-29702" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3841">(i, j)</script></span>出发，已有长度为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3842-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29703" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29704"><span class="mi" id="MathJax-Span-29705" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.684em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3842">a</script></span>，走的字母就是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3843-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29706" style="width: 38.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.768em 1000em 3.146em -0.467em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29707"><span class="munderover" id="MathJax-Span-29708"><span style="display: inline-block; position: relative; width: 2.315em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.896em -0.467em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-29709" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 1.694em;"><span class="mi" id="MathJax-Span-29710" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-29711" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mi" id="MathJax-Span-29712" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-29713" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-29714" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-29715" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29716" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29717" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29718" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29719" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-29720" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29721" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-29722" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-29723" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-29724"><span class="mrow" id="MathJax-Span-29725"><span class="mo" id="MathJax-Span-29726"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">且</span></span></span></span><span class="mi" id="MathJax-Span-29727" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-29728" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-29729" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-29730" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-29731" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29732" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-29733" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29734" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29735" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-29736" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29737" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mo" id="MathJax-Span-29738" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-29739" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-29740"><span class="mrow" id="MathJax-Span-29741"><span class="mo" id="MathJax-Span-29742"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">且</span></span></span></span><span class="mi" id="MathJax-Span-29743" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-29744" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29745" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-29746" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-29747" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-29748" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-29749" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29750" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29751" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29752" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29753" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-29754" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29755" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29756" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mi" id="MathJax-Span-29757" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-29758" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-29759" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-29760" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29761" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-29762" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29763" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29764" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-29765" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-29766" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-29767" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mi" id="MathJax-Span-29768" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">l</span><span class="mo" id="MathJax-Span-29769" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-29770" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.414em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3843">\min_w next[i][w] \ne -1 且 next[j][w] \ne -1 且 f(next[i][w], next[j][w]) \ge l - a</script></span>。按照此规则从<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3844-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29771" style="width: 2.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29772"><span class="mo" id="MathJax-Span-29773" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-29774" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-29775" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-29776" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-29777" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3844">(0, 0)</script></span>出发，走<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3845-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29778" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29779"><span class="mi" id="MathJax-Span-29780" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3845">l</script></span>步即可得到答案。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3846-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29781" style="width: 10.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.306em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29782"><span class="mi" id="MathJax-Span-29783" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29784" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-29785" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29786" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-29787" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-29788" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-29789" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mo" id="MathJax-Span-29790" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-29791"><span class="mrow" id="MathJax-Span-29792"><span class="mo" id="MathJax-Span-29793" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29794" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29795" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29796" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29797" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29798" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29799"><span class="mrow" id="MathJax-Span-29800"><span class="mo" id="MathJax-Span-29801" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29802" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3846">O((nm + l)|alpha|)</script></span>。</p><h3 id="16-k小字典序子序列（相同的算一个）"><a name="16-k小字典序子序列（相同的算一个）" href="#16-k小字典序子序列（相同的算一个）"></a>16 k小字典序子序列（相同的算一个）</h3><p>给出一个串，求其第k小字典序子序列。<br>相同的子序列算一个，则就相当于在next数组上走，每次考虑走字母w能获得的子序列个数是否不超过k，如果不超过，则这一位为w；否则，令k减去该个数，并考虑下一个字母。如果k为0，则停止并输出答案。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3847-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29803" style="width: 6.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.137em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29804"><span class="mi" id="MathJax-Span-29805" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29806" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29807" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-29808"><span class="mrow" id="MathJax-Span-29809"><span class="mo" id="MathJax-Span-29810" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29811" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29812" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29813" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29814" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29815" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29816"><span class="mrow" id="MathJax-Span-29817"><span class="mo" id="MathJax-Span-29818" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29819" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3847">O(n|alpha|)</script></span>。</p><h3 id="17-长度范围内的k小字典序子序列（相同的算一个）"><a name="17-长度范围内的k小字典序子序列（相同的算一个）" href="#17-长度范围内的k小字典序子序列（相同的算一个）"></a>17 长度范围内的k小字典序子序列（相同的算一个）</h3><p>给出一个串，求其长度在<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3848-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29820" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29821"><span class="mo" id="MathJax-Span-29822" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-29823" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-29824" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-29825" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">r</span><span class="mo" id="MathJax-Span-29826" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3848">[l, r]</script></span>之间的k小字典序子序列。<br>考虑修改问题15的统计个数的方式。其实我们只需要用问题12的计数方法即可解决此问题。<br>注意当<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3849-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29827" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 2.918em -0.444em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29828"><span class="mi" id="MathJax-Span-29829" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-29830" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-29831" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.007em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3849">k=0</script></span>的时候，如果长度不足<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3850-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29832" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29833"><span class="mi" id="MathJax-Span-29834" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3850">l</script></span>，要沿着最小字典序走到长度<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3851-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29835" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-29836"><span class="mi" id="MathJax-Span-29837" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3851">l</script></span>。<br>时间复杂度：<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3852-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29838" style="width: 6.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-29839"><span class="mi" id="MathJax-Span-29840" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-29841" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29842" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-29843" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="texatom" id="MathJax-Span-29844"><span class="mrow" id="MathJax-Span-29845"><span class="mo" id="MathJax-Span-29846" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-29847" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-29848" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-29849" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-29850" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-29851" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="texatom" id="MathJax-Span-29852"><span class="mrow" id="MathJax-Span-29853"><span class="mo" id="MathJax-Span-29854" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-29855" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3852">O(nr|alpha|)</script></span>。</p><h2 id="总结"><a name="总结" href="#总结"></a>总结</h2><p>序列自动机给了我们一个强有力的理论支撑，让我们可以更加系统的处理一类关于子串的最优化问题，也提供了唯一可以用于子串计数的工具，甚至送给了我们一个绝妙的附属品：关于字典序的处理。</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
